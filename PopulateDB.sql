CREATE  DATABASE rto;
USE rto;

CREATE TABLE MANUFACTURER(Revenue DECIMAL(20, 2), ID VARCHAR(10) PRIMARY KEY, Name VARCHAR(10) Unique, Phone_Number LONG, Email_ID VARCHAR(50));
INSERT INTO MANUFACTURER VALUES(122000, 'MARUTI', 'Maruti', 18001021800, 'contact@maruti.co.in');
INSERT INTO MANUFACTURER VALUES(34021, 'HMC', 'Honda', 1800113121, 'customer_relations@hondacarindia.com');
INSERT INTO MANUFACTURER VALUES(47042, 'HMIL', 'Hyundai', 1800114645, 'crsales@hmil.net');
INSERT INTO MANUFACTURER VALUES(14439.71, 'TM', 'Toyota', 18003090001, 'voc@toyota-kirloskar.co.in');
INSERT INTO MANUFACTURER VALUES(146000, 'M&M', 'Mahindra', 18002096006, 'customercare@mahindra.com');
CREATE TABLE RTO(RTO_ID char(7) PRIMARY KEY, Name varchar(25), Address varchar(50), Phone LONG);
INSERT INTO RTO VALUES('KA41', 'Jnanabharati', 'Kengeri', 8023286712);
INSERT INTO RTO VALUES('KA51', 'Electronic City', 'Bannerghatta', 8029911921);
INSERT INTO RTO VALUES('KA05', 'Bengaluru South', 'Jayanagar', 8026630989);
INSERT INTO RTO VALUES('KA04', 'Bengaluru North', 'Yeshwantpura', 8023376039);
INSERT INTO RTO VALUES('KA01', 'Bengaluru Central', 'HSR Layout', 8025533525);
INSERT INTO RTO VALUES('KA14', 'Shivamogga', 'Sowlang Road', 8182222209);
CREATE TABLE CUSTOMER(Invoice_no varchar(25) PRIMARY KEY, Name varchar(15), Phone_No LONG, Address varchar(200), Email_ID varchar(50), Driving_Licence varchar(20), DOB date);
INSERT INTO CUSTOMER VALUES('CAR-INV-AB34X9-2024', 'RAMESH P', 7465827677, '123 MG Road, Bengaluru, Karnataka 560001', 'ramesh@gmail.com', 'KA01 20230000001', '1998-02-20');
INSERT INTO CUSTOMER VALUES('CAR-INV-7UYT23-2024', 'SURESH S', 9701678941, '789 Koramangala 4th Block, Bengaluru, Karnataka 560034', '22suresh@gmail.com', 'KA02 20230000002', '1995-12-22');
INSERT INTO CUSTOMER VALUES('CAR-INV-PLM89N-2024', 'VIGNESH R', 6814881679, '1718 Jayanagar 3rd Block, Bengaluru, Karnataka 560041', 'rvignesh1@gmail.com', 'KA31 20230000003', '2000-11-01');
INSERT INTO CUSTOMER VALUES('CAR-INV-45FDX7-2024', 'KAMALESH BP', 9635760522, '2324 Banashankari 2nd Stage, Bengaluru, Karnataka 560070', 'kamalesh98@gmail.com', 'KA41 20230000004', '2003-04-30');
INSERT INTO CUSTOMER VALUES('CAR-INV-RV67BN-2024', 'DINESH R', 951075995, '3132 JP Nagar 6th Phase, Bengaluru, Karnataka 560078', 'dineshraju@gmail.com', 'KA05 20230000005', '2004-05-14');
INSERT INTO CUSTOMER VALUES('CAR-INV-XC12VR-2024', 'VAGEESH S', 6361556972, '23 PoornaPragna Layout,Bengaluru ,Karnataka 560060', 'satish.vageesh@gmail.com', 'KA14 20230000014', '2004-04-23');
INSERT INTO CUSTOMER VALUES('CAR-INV-9KLO56-2024', 'GANESH M', 6899104606, '2122 Yeshwanthpur Industrial Area, Bengaluru, Karnataka 560022', 'ganeshm@gmail.com', 'KA12 20230000012', '1990-10-10');
INSERT INTO CUSTOMER VALUES('CAR-INV-3YHGT2-2024', 'DINESH R', 951075995, '3132 JP Nagar 6th Phase, Bengaluru, Karnataka 560078', 'dineshraju@gmail.com', 'KA05 20230000005', '2004-05-14');
INSERT INTO CUSTOMER VALUES('CAR-INV-TQ54MN-2024', 'VAGEESH S', 6361556972, '23 PoornaPragna Layout,Bengaluru ,Karnataka 560060', 'satish.vageesh@gmail.com', 'KA14 20230000014', '2004-04-23');
INSERT INTO CUSTOMER VALUES('CAR-INV-12BNVG-2024', 'RAMESH P', 7465827677, '123 MG Road, Bengaluru, Karnataka 560001', 'ramesh@gmail.com', 'KA01 20230000001', '1998-02-20');
INSERT INTO CUSTOMER VALUES('CAR-INV-WE67CX-2024', 'DINESH R', 951075995, '3132 JP Nagar 6th Phase, Bengaluru, Karnataka 560078', 'dineshraju@gmail.com', 'KA05 20230000005', '2004-05-14');
INSERT INTO CUSTOMER VALUES('CAR-INV-OP98LK-2024', 'SURESH S', 9701678941, '789 Koramangala 4th Block, Bengaluru, Karnataka 560034', '22suresh@gmail.com', 'KA02 20230000002', '1995-12-22');
INSERT INTO CUSTOMER VALUES('CAR-INV-6YHG43-2024', 'DHARNESH C', 7664530718, '2728 Rajajinagar 5th Block, Bengaluru, Karnataka 560010', 'dharnesh_33@gmail.com', 'KA09 20230000009', '2001-09-17');
INSERT INTO CUSTOMER VALUES('CAR-INV-BG34CX-2024', 'VENKATESH P', 7118966142, '2526 Marathahalli Outer Ring Road, Bengaluru, Karnataka 560037', 'venki21@gmail.com', 'KA10 20230000010', '1989-02-13');
INSERT INTO CUSTOMER VALUES('CAR-INV-1MN89V-2024', 'VAGEESH S', 6361556972, '23 PoornaPragna Layout,Bengaluru ,Karnataka 560060', 'satish.vageesh@gmail.com', 'KA14 20230000014', '2004-04-23');
INSERT INTO CUSTOMER VALUES('CAR-INV-RX12ZU-2024', 'MAHANTESH R', 9001829805, '314 Whitefield Main Road, Bengaluru, Karnataka 560066', 'mahantesh12@gmail.com', 'KA07 20230000007', '2000-12-31');
INSERT INTO CUSTOMER VALUES('CAR-INV-78JHG2-2024', 'BRIJESH GOWDA', 9242338492, '41 Padmanabhanagar,Bengaluru,Karnataka 560070', 'brij_gowda@gmail.com', 'KA06 20230000006', '2003-01-01');
INSERT INTO CUSTOMER VALUES('CAR-INV-LOP9M6-2024', 'VIGNESH R', 6814881679, '1718 Jayanagar 3rd Block, Bengaluru, Karnataka 560041', 'rvignesh1@gmail.com', 'KA31 20230000003', '2000-11-01');
INSERT INTO CUSTOMER VALUES('CAR-INV-56XDF7-2024', 'BRIJESH GOWDA', 9242338492, '41 Padmanabhanagar,Bengaluru,Karnataka 560070', 'brij_gowda@gmail.com', 'KA06 20230000006', '2003-01-01');
INSERT INTO CUSTOMER VALUES('CAR-INV-VG89LP-2024', 'KAMALESH BP', 9635760522, '2324 Banashankari 2nd Stage, Bengaluru, Karnataka 560070', 'kamalesh98@gmail.com', 'KA41 20230000004', '2003-04-30');
INSERT INTO CUSTOMER VALUES('CAR-INV-9KJHG5-2024', 'HIMESH O', 7451236780, '3536 Frazer Town, Mosque Road, Bengaluru, Karnataka 560005', 'himeshomprakash@gmail.com', 'KA11 20230000009', '1990-06-26');
INSERT INTO CUSTOMER VALUES('CAR-INV-34BNZX-2024', 'MUKESH GOWDA', 9535122178, '94 SBM Colony HanumanthNagar,Bengaluru,Karnatak 560054', 'mukeshgowda@gmail.com', 'KA17 20220000006', '2004-07-03');
INSERT INTO CUSTOMER VALUES('CAR-INV-MP67XC-2024', 'RITESH P', 9238183017, '738 Richmond Town, Richmond Road, Bengaluru, Karnataka 560025', 'riteshp@gmail.com', 'KA03 20210000087', '1999-08-15');
INSERT INTO CUSTOMER VALUES('CAR-INV-12DFGV-2024', 'DHARNESH C', 7664530718, '2728 Rajajinagar 5th Block, Bengaluru, Karnataka 560010', 'dharnesh_33@gmail.com', 'KA09 20230000009', '2001-09-17');
INSERT INTO CUSTOMER VALUES('CAR-INV-RT98NB-2024', 'VENKATESH P', 7118966142, '2526 Marathahalli Outer Ring Road, Bengaluru, Karnataka 560037', 'venki21@gmail.com', 'KA10 20230000010', '1989-02-13');
CREATE TABLE BUY_FROM(Invoice_no varchar(25), ID varchar(10), DealerID varchar(20), FOREIGN KEY (Invoice_no) REFERENCES CUSTOMER(Invoice_no), FOREIGN KEY (ID) REFERENCES MANUFACTURER(ID));
INSERT INTO BUY_FROM VALUES('CAR-INV-AB34X9-2024', 'HMC', 'Dakshin');
INSERT INTO BUY_FROM VALUES('CAR-INV-7UYT23-2024', 'M&M', 'Sireesh Auto');
INSERT INTO BUY_FROM VALUES('CAR-INV-PLM89N-2024', 'MARUTI', 'Kalyani');
INSERT INTO BUY_FROM VALUES('CAR-INV-45FDX7-2024', 'M&M', 'Anant Motors');
INSERT INTO BUY_FROM VALUES('CAR-INV-RV67BN-2024', 'HMIL', 'Blue Hyundai');
INSERT INTO BUY_FROM VALUES('CAR-INV-XC12VR-2024', 'TM', 'Nandi');
INSERT INTO BUY_FROM VALUES('CAR-INV-9KLO56-2024', 'HMC', 'Brigade');
INSERT INTO BUY_FROM VALUES('CAR-INV-3YHGT2-2024', 'MARUTI', 'Mandovi');
INSERT INTO BUY_FROM VALUES('CAR-INV-TQ54MN-2024', 'HMC', 'Dakshin');
INSERT INTO BUY_FROM VALUES('CAR-INV-12BNVG-2024', 'MARUTI', 'Mandovi');
INSERT INTO BUY_FROM VALUES('CAR-INV-WE67CX-2024', 'TM', 'Nandi');
INSERT INTO BUY_FROM VALUES('CAR-INV-OP98LK-2024', 'M&M', 'Sireesh Auto');
INSERT INTO BUY_FROM VALUES('CAR-INV-6YHG43-2024', 'TM', 'Viva');
INSERT INTO BUY_FROM VALUES('CAR-INV-BG34CX-2024', 'HMIL', 'Blue Hyundai');
INSERT INTO BUY_FROM VALUES('CAR-INV-1MN89V-2024', 'HMC', 'Brigade');
INSERT INTO BUY_FROM VALUES('CAR-INV-RX12ZU-2024', 'TM', 'Nandi');
INSERT INTO BUY_FROM VALUES('CAR-INV-78JHG2-2024', 'HMIL', 'Advaith Hyundai');
INSERT INTO BUY_FROM VALUES('CAR-INV-LOP9M6-2024', 'HMC', 'Magnum');
INSERT INTO BUY_FROM VALUES('CAR-INV-56XDF7-2024', 'HMC', 'Brigade');
INSERT INTO BUY_FROM VALUES('CAR-INV-VG89LP-2024', 'MARUTI', 'Kalyani');
INSERT INTO BUY_FROM VALUES('CAR-INV-9KJHG5-2024', 'HMC', 'Dakshin');
INSERT INTO BUY_FROM VALUES('CAR-INV-34BNZX-2024', 'HMC', 'Brigade');
INSERT INTO BUY_FROM VALUES('CAR-INV-MP67XC-2024', 'M&M', 'Sireesh Auto');
INSERT INTO BUY_FROM VALUES('CAR-INV-12DFGV-2024', 'HMC', 'Dakshin');
INSERT INTO BUY_FROM VALUES('CAR-INV-RT98NB-2024', 'HMIL', 'Pavan Hyundai');
CREATE TABLE MODEL(Base_price DECIMAL(10,2), Year_of_prod YEAR, Model_Name VARCHAR(20), ID INT PRIMARY KEY, Fuel_type VARCHAR(10), Manufacturer_Name VARCHAR(10), FOREIGN KEY (Manufacturer_Name) REFERENCES MANUFACTURER(Name));
INSERT INTO MODEL VALUES(500000, 2020, 'Swift', 1, 'Petrol', 'Maruti');
INSERT INTO MODEL VALUES(840000, 2021, 'City', 2, 'Petrol', 'Honda');
INSERT INTO MODEL VALUES(650000, 2019, 'i20', 3, 'Diesel', 'Hyundai');
INSERT INTO MODEL VALUES(1200000, 2022, 'Corolla', 4, 'Petrol', 'Toyota');
INSERT INTO MODEL VALUES(1100000, 2020, 'Thar', 5, 'Diesel', 'Mahindra');
INSERT INTO MODEL VALUES(650000, 2021, 'Baleno', 6, 'Petrol', 'Maruti');
INSERT INTO MODEL VALUES(850000, 2023, 'Elevate', 7, 'Diesel', 'Honda');
INSERT INTO MODEL VALUES(1200000, 2020, 'Creta', 8, 'Petrol', 'Hyundai');
INSERT INTO MODEL VALUES(3400000, 2021, 'Fortuner', 9, 'Diesel', 'Toyota');
INSERT INTO MODEL VALUES(750000, 2019, 'XUV500', 10, 'Diesel', 'Mahindra');
INSERT INTO MODEL VALUES(600000, 2021, 'Dzire', 11, 'Petrol', 'Maruti');
INSERT INTO MODEL VALUES(1300000, 2020, 'Civic', 12, 'Diesel', 'Honda');
INSERT INTO MODEL VALUES(400000, 2018, 'Santro', 13, 'Petrol', 'Hyundai');
INSERT INTO MODEL VALUES(800000, 2019, 'Yaris', 14, 'Petrol', 'Toyota');
INSERT INTO MODEL VALUES(750000, 2021, 'Scorpio', 15, 'Diesel', 'Mahindra');
INSERT INTO MODEL VALUES(650000, 2020, 'Ertiga', 16, 'Petrol', 'Maruti');
INSERT INTO MODEL VALUES(850000, 2022, 'BR-V', 17, 'Diesel', 'Honda');
INSERT INTO MODEL VALUES(700000, 2020, 'Venue', 18, 'Petrol', 'Hyundai');
INSERT INTO MODEL VALUES(2000000, 2016, 'Innova Crysta', 19, 'Petrol', 'Toyota');
INSERT INTO MODEL VALUES(800000, 2019, 'KUV100', 20, 'Petrol', 'Mahindra');
CREATE TABLE CAR(Reg_no CHAR(10), Model_ID INT, Color VARCHAR(10), Mileage FLOAT, Date_of_Registration DATE, Chassis_no VARCHAR(20), Engine_no VARCHAR(20), RTO_ID CHAR(4), Invoice_Number varchar(25), PRIMARY KEY (Reg_no), FOREIGN KEY (Model_ID) REFERENCES MODEL(ID), FOREIGN KEY (RTO_ID) REFERENCES RTO(RTO_ID), FOREIGN KEY (Invoice_Number) REFERENCES CUSTOMER(Invoice_no));
INSERT INTO CAR VALUES ('KA01IJ3456', 5, 'Navy Blue', 13, '2020-09-02', 'MA1NA2LHXW2201252', 'F29J4998952', 'KA01', 'CAR-INV-RV67BN-2024');
INSERT INTO CAR VALUES ('KA01UV6543', 11, 'Orange', 21, '2013-03-04', 'MA3EJKD1SP6925177', 'C96L2474662', 'KA01', 'CAR-INV-WE67CX-2024');
INSERT INTO CAR VALUES ('KA01GH1234', 17, 'Yellow', 15, '2014-08-16', 'MHRDG2650T3022462', 'W28T6534433', 'KA01', 'CAR-INV-78JHG2-2024');
INSERT INTO CAR VALUES ('KA01ST9087', 15, 'Tan', 12, '2010-11-23', 'MA1TA2VYXN6085213', 'X58H6477940', 'KA01', 'CAR-INV-MP67XC-2024');
INSERT INTO CAR VALUES ('KA04GH9876', 4, 'Silver', 16, '2016-01-24', 'MBHEBRB1JF8211510', 'E75L4318403', 'KA04', 'CAR-INV-45FDX7-2024');
INSERT INTO CAR VALUES ('KA04ST8765', 10, 'Black', 12, '2018-09-06', 'MA1YA2TYNN9272449', 'R76T2213576', 'KA04', 'CAR-INV-12BNVG-2024');
INSERT INTO CAR VALUES ('KA04EF7890', 16, 'Gold', 18, '2014-08-06', 'MA3ELMF1SS9704545', 'I92F9997715', 'KA04', 'CAR-INV-RX12ZU-2024');
INSERT INTO CAR VALUES ('KA04QR2345', 12, 'Tan', 16, '2013-08-15', '2HGFC2F59T6577270', 'Y99Q6344866', 'KA04', 'CAR-INV-34BNZX-2024');
INSERT INTO CAR VALUES ('KA05EF4567', 3, 'Green', 18, '2017-10-17', 'MALBM51BLS2320227', 'S52H9396830', 'KA05', 'CAR-INV-PLM89N-2024');
INSERT INTO CAR VALUES ('KA05QR5678', 9, 'Brown', 11, '2022-03-16', 'MHFAX29G4I9983719', 'T70N4234267', 'KA05', 'CAR-INV-TQ54MN-2024');
INSERT INTO CAR VALUES ('KA05CD5674', 15, 'Blue', 12, '2020-08-05', 'MA1TA2VYXH3865215', 'R43G4850845', 'KA05', 'CAR-INV-1MN89V-2024');
INSERT INTO CAR VALUES ('KA05OP4567', 17, 'White', 15, '2010-04-14', 'MHRDG2650T7046043', 'F93O6264624', 'KA05', 'CAR-INV-9KJHG5-2024');
INSERT INTO CAR VALUES ('KA14KL1234', 6, 'White', 21, '2011-07-07', 'MA3EYD32SK8372908', 'E87L7438696', 'KA14', 'CAR-INV-XC12VR-2024');
INSERT INTO CAR VALUES ('KA14WX3456', 12, 'Red', 16, '2023-09-09', '2HGFC2F59Z6401065', 'B16G3302569', 'KA14', 'CAR-INV-OP98LK-2024');
INSERT INTO CAR VALUES ('KA14IJ6789', 18, 'White', 18, '2016-11-03', 'MALF381CLQ3171279', 'Q20L8529113', 'KA14', 'CAR-INV-LOP9M6-2024');
INSERT INTO CAR VALUES ('KA14UV6789', 1, 'Silver', 21, '2012-08-18', 'MA3EKKD1SO1769186', 'B33X2233936', 'KA14', 'CAR-INV-12DFGV-2024');
INSERT INTO CAR VALUES ('KA41AB2345', 1, 'Orange', 21, '2015-04-30', 'MA3EKKD1SI3814774', 'A11Q8609501', 'KA41', 'CAR-INV-AB34X9-2024');
INSERT INTO CAR VALUES ('KA41MN7890', 7, 'Beige', 14, '2019-01-27', 'MHRDC2660W8174220', 'X95M3029178', 'KA41', 'CAR-INV-9KLO56-2024');
INSERT INTO CAR VALUES ('KA41YZ9087', 13, 'Purple', 20, '2016-10-19', 'MALAA51CLL7409296', 'W44O2569041', 'KA41', 'CAR-INV-6YHG43-2024');
INSERT INTO CAR VALUES ('KA41KL3456', 19, 'Yellow', 8, '2017-06-01', 'MBJB29GX0M3886185', 'G13U9238531', 'KA41', 'CAR-INV-56XDF7-2024');
INSERT INTO CAR VALUES ('KA41WX3456', 7, 'Burgundy', 14, '2019-06-06', 'MHRDC2660G7917309', 'X77L9888702', 'KA41', 'CAR-INV-RT98NB-2024');
INSERT INTO CAR VALUES ('KA51CD6789', 2, 'White', 17, '2018-11-24', 'MHMGC26E0Z9281896', 'G65E7586712', 'KA51', 'CAR-INV-7UYT23-2024');
INSERT INTO CAR VALUES ('KA51OP4321', 8, 'Brown', 17, '2019-10-04', 'MALPB81BLW6637250', 'V43F3071903', 'KA51', 'CAR-INV-3YHGT2-2024');
INSERT INTO CAR VALUES ('KA51AB4321', 14, 'Burgundy', 17, '2010-06-11', 'MBJDD2BT0M9924707', 'T15B7549989', 'KA51', 'CAR-INV-BG34CX-2024');
INSERT INTO CAR VALUES ('KA51MN8765', 20, 'Burgundy', 18, '2010-08-31', 'MA1VA2WHXU2952985', 'V94B3304622', 'KA51', 'CAR-INV-VG89LP-2024');
CREATE TABLE user_login (
    user_id VARCHAR(50),
    password VARCHAR(100)
);

CREATE TABLE manufacturer_login (
    username VARCHAR(50),
    password VARCHAR(100),
    manufacturer_id VARCHAR(50)
);

CREATE TABLE rto_login (
    user_id VARCHAR(50),
    password VARCHAR(100)
);

INSERT INTO user_login (user_id, password)
VALUES
('RAMESH P', 'password123'),
('SURESH S', 'password456'),
('VIGNESH R', 'password789');

INSERT INTO manufacturer_login (username, password, manufacturer_id)
VALUES
('Honda', 'honda456', 'HMC'),
('Hyundai', 'hyundai789', 'HMIL'),
('Maruti', 'maruti123', 'MARUTI');

INSERT INTO rto_login (user_id, password)
VALUES
('KA01', 'admin123'),
('KA04', 'admin456'),
('KA41', 'admin789');

CREATE or replace VIEW Manufacturer_View AS
SELECT m.ID, m.Name, m.Phone_Number, m.Email_ID, m.Revenue, COUNT(c.Invoice_no) AS Total_Cars_Sold
FROM MANUFACTURER m
JOIN BUY_FROM bf ON m.ID = bf.ID
JOIN CUSTOMER c ON bf.Invoice_no = c.Invoice_no
GROUP BY m.ID, m.Name, m.Phone_Number, m.Email_ID, m.Revenue;

CREATE VIEW RTO_VIEW AS SELECT R.RTO_ID, R.Name,CA.Reg_no, C.Name AS Owner_Name FROM RTO R JOIN CAR CA ON R.RTO_ID = CA.RTO_ID JOIN CUSTOMER C ON CA.Invoice_Number = C.Invoice_no;
